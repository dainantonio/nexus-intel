<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS INTEL | AI × Data × Energy × Policy</title>
    
    <link rel="manifest" href="manifest.json">
    
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://unpkg.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
    
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js" defer></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts" defer></script>
</head>
<body>

    <div class="scanlines" style="display: none;"></div>
    <div class="crt-flicker" style="display: none;"></div>
    <div class="glow-overlay" style="display: none;"></div>

    <div id="cyberTooltip" class="cyber-tooltip"></div>

    <div id="notificationArea" class="notification">
        <i data-lucide="check-circle" style="color: var(--color-electric-green)"></i>
        <span id="notificationText">System Ready</span>
    </div>

    <div id="bulkActionBar" class="bulk-action-bar">
        <div class="bulk-counter">0 SELECTED</div>
        <button class="action-btn" onclick="bulkMarkRead()" title="Mark Read"><i data-lucide="check-square"></i></button>
        <button class="action-btn" onclick="bulkBookmark()" title="Bookmark"><i data-lucide="bookmark"></i></button>
        <button class="action-btn" onclick="toggleBulkMode()" title="Exit Bulk Mode" style="border-color:#ff4757; color:#ff4757;"><i data-lucide="x"></i></button>
    </div>

    <div class="modal-overlay" id="searchModal">
        <div class="modal-content">
            <div class="search-container">
                <div class="search-header">
                    <i data-lucide="search" style="color: var(--color-electric-green);"></i>
                    <input type="text" class="search-input" id="searchInput" placeholder="Search global intelligence..." aria-label="Search" autocomplete="off">
                    <button class="action-btn" id="closeSearchBtn" aria-label="Close Search"><i data-lucide="x"></i></button>
                </div>
                <div class="search-results" id="searchResults"></div>
                <div class="search-footer">
                    <span><i data-lucide="arrow-up" size="12"></i> <i data-lucide="arrow-down" size="12"></i> to navigate</span>
                    <span><i data-lucide="corner-down-left" size="12"></i> to select</span>
                    <span><span style="border: 1px solid #333; padding: 2px 6px; border-radius: 4px;">ESC</span> to close</span>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="readerModal">
        <div class="modal-content">
            <div class="reader-container">
                <div style="display:flex; justify-content:flex-end; margin-bottom:10px;">
                    <button class="action-btn" onclick="document.getElementById('readerModal').classList.remove('active')" aria-label="Close Reader"><i data-lucide="x"></i></button>
                </div>
                <h1 id="readerTitle" class="reader-title">Article Title</h1>
                <div class="reader-meta">
                    <span id="readerSource">Source</span>
                    <span>•</span>
                    <span id="readerTime">Time</span>
                    <span id="readerTag" class="reader-badge">TAG</span>
                </div>
                <div id="readerBody" class="reader-content"></div>
                <div style="margin-top: 30px; border-top: 1px solid var(--color-border); padding-top: 20px;">
                    <h3 style="color: var(--color-electric-green); font-size: 0.9rem; margin-bottom: 10px;">INTELLIGENCE SUMMARY</h3>
                    <div id="readerAiSummary" style="font-size: 0.95rem; color: #aaa; background: rgba(0,255,157,0.05); padding: 15px; border-radius: 8px;"></div>
                </div>
                <div style="margin-top: 20px; display:flex; justify-content:center;">
                    <button class="ai-analysis-btn" id="readerExternalLink" style="width: auto; padding: 10px 25px;">OPEN ORIGINAL SOURCE <i data-lucide="external-link" size="14"></i></button>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="infoModal">
        <div class="modal-content">
            <div class="info-container">
                <div class="info-header">
                    <div class="info-tabs">
                        <div class="info-tab active" data-tab="api">API DOCS</div>
                        <div class="info-tab" data-tab="logs">SYSTEM LOGS</div>
                        <div class="info-tab" data-tab="privacy">PRIVACY</div>
                        <div class="info-tab" data-tab="terms">TERMS</div>
                    </div>
                    <button class="action-btn" id="closeInfoBtn"><i data-lucide="x"></i></button>
                </div>
                <div class="info-body">
                    <div id="tab-api" class="info-section active">
                        <h3 style="margin-bottom:15px; color:white;">Nexus API v4.0.2</h3>
                        <p style="color:#aaa; font-size:0.9rem; margin-bottom:10px;">Access the global intelligence stream programmatically.</p>
                        <div style="background:rgba(0,0,0,0.3); padding:15px; border-radius:8px; font-family:'JetBrains Mono'; color:#00ff9d; font-size:0.8rem; margin-bottom:20px;">
                            GET https://api.nexus-intel.io/v1/stream/latest<br>
                            Authorization: Bearer YOUR_API_KEY
                        </div>
                        <p style="color:#aaa; font-size:0.9rem;">Rate limits: 500 req/min for Enterprise tier.</p>
                    </div>
                    <div id="tab-logs" class="info-section">
                        <h3 style="margin-bottom:15px; color:white;">System Event Stream</h3>
                        <div id="systemLogContainer" style="height:300px; overflow-y:auto; background:rgba(0,0,0,0.3); padding:15px; border-radius:8px;"></div>
                    </div>
                    <div id="tab-privacy" class="info-section">
                        <h3 style="margin-bottom:15px; color:white;">Data Privacy Protocol</h3>
                        <p style="color:#aaa; line-height:1.6; font-size:0.9rem;">Nexus Intel operates on a zero-retention policy for user search queries. All geospatial data is anonymized before aggregation.</p>
                    </div>
                    <div id="tab-terms" class="info-section">
                        <h3 style="margin-bottom:15px; color:white;">Terms of Service</h3>
                        <p style="color:#aaa; line-height:1.6; font-size:0.9rem;">By accessing the NEXUS mainframe, you agree to utilize the intelligence provided for lawful predictive analysis only.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="helpModal">
        <div class="modal-content">
            <div class="settings-container">
                <div style="display: flex; justify-content: space-between; margin-bottom: 25px;">
                    <h2><i data-lucide="keyboard" style="color: var(--color-electric-green); margin-right: 10px;"></i> Shortcuts</h2>
                    <button class="action-btn" onclick="document.getElementById('helpModal').classList.remove('active')" aria-label="Close Help"><i data-lucide="x"></i></button>
                </div>
                <div class="help-grid">
                    <div class="help-item"><span>Search</span> <span class="help-key">Cmd + K</span></div>
                    <div class="help-item"><span>Toggle View</span> <span class="help-key">V</span></div>
                    <div class="help-item"><span>Refresh Data</span> <span class="help-key">R</span></div>
                    <div class="help-item"><span>Toggle Settings</span> <span class="help-key">S</span></div>
                    <div class="help-item"><span>Bulk Mode</span> <span class="help-key">B</span></div>
                    <div class="help-item"><span>Mark Read</span> <span class="help-key">M</span></div>
                    <div class="help-item"><span>Mark All Read</span> <span class="help-key">Shift + M</span></div>
                    <div class="help-item"><span>Close Modals</span> <span class="help-key">Esc</span></div>
                </div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="settingsModal">
        <div class="modal-content">
            <div class="settings-container">
                <div style="display: flex; justify-content: space-between; margin-bottom: 25px;">
                    <h2><i data-lucide="settings" style="color: var(--color-electric-green); margin-right: 10px;"></i> System Config</h2>
                    <button class="action-btn" id="closeSettingsBtn" aria-label="Close Settings"><i data-lucide="x"></i></button>
                </div>
                <div class="setting-group">
                    <h3><i data-lucide="eye"></i> Interface</h3>
                    <div class="setting-item">
                        <div>
                            <div style="font-weight: 500;">Cyberpunk Mode</div>
                            <div style="font-size: 0.8rem; color: var(--color-text-muted);">Scanlines & CRT effects</div>
                        </div>
                        <label class="switch"><input type="checkbox" id="cyberpunkToggle"><span class="slider"></span></label>
                    </div>
                </div>
                <button id="saveSettingsBtn" style="width: 100%; padding: 14px; background: var(--color-electric-green); border: none; border-radius: 8px; font-weight: 700; cursor: pointer; color: #000;">SAVE CONFIGURATION</button>
            </div>
        </div>
    </div>

    <div class="signal-ticker">
        <div class="ticker-wrap">
            <div class="ticker">
                <div class="ticker-item"><i data-lucide="activity"></i> SYSTEM ONLINE</div>
                <div class="ticker-item"><i data-lucide="globe"></i> MONITORING GLOBAL GRIDS</div>
                <div class="ticker-item"><i data-lucide="cpu"></i> AI TRAINING RUN DETECTED</div>
                <div class="ticker-item"><i data-lucide="scale"></i> EU AI ACT COMPLIANCE CHECK</div>
                <div class="ticker-item"><i data-lucide="zap"></i> DATA CENTER LOAD: NOMINAL</div>
                <div class="ticker-item"><i data-lucide="trending-up"></i> NVIDIA STOCK VOLATILITY</div>
            </div>
        </div>
    </div>

    <div class="app-container">
        <header class="app-header">
            <div class="logo-container">
                <div class="logo-icon"><i data-lucide="aperture" style="color: #0a0a0f;"></i></div>
                <div>
                    <h1 style="font-size: 1.2rem; font-weight: 800; letter-spacing: -0.5px;">NEXUS INTEL</h1>
                    <div style="font-size: 0.65rem; color: var(--color-text-muted); letter-spacing: 1.5px; font-weight: 600;">AI × DATA × ENERGY × POLICY</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="action-btn mobile-widgets-btn" id="mobileWidgetsToggle" title="Toggle Widgets"><i data-lucide="bar-chart-2"></i></button>
                <button class="action-btn" id="tldrToggleBtn" title="TL;DR Mode"><i data-lucide="list"></i></button>
                <div id="systemClock" style="font-family: 'JetBrains Mono'; font-size: 0.8rem; color: var(--color-electric-green); border: 1px solid rgba(0,255,157,0.2); padding: 8px 12px; border-radius: 8px; margin-right: 10px;">00:00:00 UTC</div>
                <button class="action-btn" id="refreshBtn" title="Refresh Feed"><i data-lucide="refresh-cw"></i></button>
                <button class="action-btn" id="triggerSearchBtn" title="Search (Cmd+K)"><i data-lucide="search"></i></button>
                <button class="action-btn" id="triggerSettingsBtn" title="Settings (S)"><i data-lucide="settings"></i></button>
            </div>
        </header>

        <div class="intelligence-aggregator">
            <div style="flex:1">
                <div style="font-size: 0.75rem; color: var(--color-text-muted); text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">Global Threat Level</div>
                <div style="font-size: 1.5rem; font-weight: 700; color: #fff;">MODERATE <span style="font-size: 0.8rem; color: var(--color-electric-green); font-weight: 400;">STABLE</span></div>
            </div>
            <div style="width: 200px; display:flex; flex-direction:column; gap:5px;">
                <div style="display:flex; justify-content:space-between; font-size:0.7rem; color:var(--color-text-muted);"><span>CONFIDENCE</span><span>94%</span></div>
                <div style="height:6px; background:rgba(255,255,255,0.1); border-radius:3px;"><div style="width:94%; height:100%; background:var(--color-data-blue); border-radius:3px;"></div></div>
            </div>
        </div>

        <div class="filter-container">
            <div class="filter-chip active" data-filter="all"><i data-lucide="layers" size="14"></i> ALL NEXUS <span class="filter-chip-count"></span><span id="badge-all" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="unread"><i data-lucide="mail" size="14"></i> UNREAD <span class="filter-chip-count"></span><span id="badge-unread" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="ai"><i data-lucide="cpu" size="14"></i> AI <span class="filter-chip-count"></span><span id="badge-ai" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="energy"><i data-lucide="zap" size="14"></i> ENERGY <span class="filter-chip-count"></span><span id="badge-energy" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="realestate"><i data-lucide="building" size="14"></i> REAL ESTATE <span class="filter-chip-count"></span><span id="badge-realestate" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="policy"><i data-lucide="scale" size="14"></i> POLICY <span class="filter-chip-count"></span><span id="badge-policy" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="breaking"><i data-lucide="alert-circle" size="14"></i> BREAKING <span class="filter-chip-count"></span></div>
            <div class="filter-chip" data-filter="saved"><i data-lucide="bookmark" size="14"></i> SAVED <span class="filter-chip-count"></span></div>
        </div>

        <aside class="left-sidebar">
            <div class="sidebar-section">
                <h3><i data-lucide="map"></i> GEOSPATIAL INTEL</h3>
                <div id="miniMap">
                    <div class="map-scan-overlay"></div>
                </div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="pie-chart"></i> IMPACT DISTRIBUTION</h3>
                <div id="impactChart"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="hash"></i> TRENDING SIGNALS</h3>
                <div id="trendingContainer"></div>
            </div>
        </aside>

        <main class="main-feed" id="mainFeed">
            <div id="breakingBanner" class="breaking-banner">
                <div style="display:flex; align-items:center; gap:12px;">
                    <i data-lucide="alert-triangle"></i>
                    <span id="breakingText">BREAKING: MAJOR REGULATORY SHIFT DETECTED</span>
                </div>
                <i data-lucide="arrow-right" size="16"></i>
            </div>
            <div class="feed-header">
                <div style="display:flex; align-items:center; gap: 15px;">
                    <h2 id="feedTitle" style="font-size:1.1rem; font-weight:700;">LIVE INTELLIGENCE</h2>
                    <span style="font-size:0.75rem; background:rgba(255,255,255,0.1); padding:4px 8px; border-radius:4px;"><span id="articleCount">0</span> NODES</span>
                </div>
                <div class="feed-controls">
                     <div class="view-toggle">
                        <button class="view-btn active" data-view="row" title="Row View"><i data-lucide="rows" size="16"></i></button>
                        <button class="view-btn" data-view="grid" title="Grid View"><i data-lucide="layout-grid" size="16"></i></button>
                    </div>
                    <select id="sortSelect" class="sort-select">
                        <option value="latest">Latest</option>
                        <option value="unread_first">Unread First</option>
                        <option value="impact">Highest Impact</option>
                    </select>
                </div>
            </div>
            <div id="articlesContainer"></div>
        </main>

        <aside class="right-sidebar" id="rightSidebar">
            <div class="sidebar-section">
                <div class="brief-header" onclick="toggleBrief()">
                    <h3><i data-lucide="list"></i> TOP INTELLIGENCE BRIEF</h3>
                    <i data-lucide="chevron-up" id="briefChevron" style="width:16px; transition: transform 0.3s;"></i>
                </div>
                <div id="topBriefWidget" class="brief-content-wrapper"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="gauge"></i> MARKET SENTIMENT</h3>
                <div class="sentiment-gauge-wrapper">
                    <div id="sentimentRadialChart"></div>
                    <div class="sentiment-value-overlay">
                        <div id="sentimentValue" class="sentiment-score">--</div>
                        <div id="sentimentText" class="sentiment-text">ANALYZING</div>
                    </div>
                </div>
            </div>
        </aside>

        <footer class="app-footer">
            <div class="footer-status">
                <div class="footer-status-item"><div class="status-dot"></div><span>SECURE TLS v1.3</span></div>
                <div class="footer-status-item"><span>LATENCY: <span id="footerLatency">12ms</span></span></div>
            </div>
            <div class="footer-center">NEXUS INTEL v4.0.2 | © 2026</div>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
