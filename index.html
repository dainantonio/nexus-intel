<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS INTEL | V9.5 STABLE</title>
    
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts"></script>
    <script type="text/javascript" src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <link rel="stylesheet" href="styles.css">
</head>
<body class="cyberpunk-mode">

    <div class="toast-notification" id="toast">
        <i data-lucide="alert-circle" style="color:var(--accent-red)"></i>
        <div id="toastMessage">Error message here</div>
        <i data-lucide="x" class="toast-close" onclick="hideToast()"></i>
    </div>

    <header class="app-header">
        <div class="logo-area">
            <div class="logo-icon"><i data-lucide="aperture"></i></div>
            <div class="logo-text">NEXUS INTEL <span style="font-weight:400; opacity:0.5; font-size:0.8em;">v9.5</span></div>
        </div>

        <div class="search-container">
            <i data-lucide="search" class="search-icon"></i>
            <input type="text" class="search-input" id="globalSearch" placeholder="Command + K to search..." onkeyup="handleSearch(this.value)">
        </div>

        <div style="display: flex; gap: 4px; align-items: center;">
            <div style="font-family:var(--font-mono); font-size:0.75rem; margin-right: 12px;" id="clock">00:00 UTC</div>

            <button class="action-btn refresh-btn" id="refreshBtn" title="Refresh Now" onclick="manualRefresh()">
                <i data-lucide="rotate-cw"></i>
            </button>
            <button class="action-btn zen-toggle" id="zenToggle" title="Zen Mode" onclick="toggleZenMode()">
                <i data-lucide="eye"></i>
            </button>
            <button class="action-btn" title="Settings" onclick="toggleSettings()"><i data-lucide="sliders-horizontal"></i></button>
            <button class="action-btn" title="Alerts" onclick="toggleAlerts()"><i data-lucide="bell"></i></button>
        </div>
    </header>

    <div class="signal-ticker">
        <div class="ticker-content">
            <div class="ticker-item">SSI RAISES $5B @ $15B VAL</div>
            <div class="ticker-item">NVIDIA B200 SHIPPING Q2</div>
            <div class="ticker-item">OPENAI "OPERATOR" RELEASED TO BETA</div>
            <div class="ticker-item">ANTHROPIC PUBLISHES CONSTITUTION 2.0</div>
            <div class="ticker-item">TSMC 2NM YIELDS EXCEED TARGET</div>
        </div>
    </div>

    <div class="intelligence-aggregator">
        <div class="agg-group">
            <div class="agg-label"><i data-lucide="shield-alert" style="width:12px; margin-right:6px; color:var(--accent-orange)"></i> Global Threat Level</div>
            <div class="agg-data-row">
                <span class="agg-value">MODERATE</span>
                <span class="agg-sub">STABLE</span>
            </div>
        </div>
        
        <div class="confidence-wrapper">
            <div class="confidence-stats">
                <span id="systemStatus">SYSTEM ONLINE</span>
                <span id="systemConfidence">94%</span>
            </div>
            <div class="confidence-track">
                <div class="confidence-fill" id="statusFill"></div>
            </div>
        </div>
    </div>

    <div class="app-container">
        
        <aside class="left-sidebar">
            <div>
                <div class="sidebar-header"><i data-lucide="globe"></i> GLOBAL INTEL</div>
                <div style="position:relative;">
                    <div id="miniMap"></div>
                    <div class="intel-list" id="globalIntelList"></div>
                </div>
            </div>

            <div>
                <div class="sidebar-header"><i data-lucide="activity"></i> MARKET PULSE</div>
                <div style="display:grid; grid-template-columns: 1fr 1fr; gap:8px;">
                    <div style="background:rgba(255,255,255,0.03); padding:12px; border-radius:var(--radius);">
                        <div style="font-size:0.65rem; color:var(--text-muted);">SENTIMENT</div>
                        <div style="color:var(--accent-green); font-family:var(--font-mono); font-weight:700;">BULLISH</div>
                    </div>
                    <div style="background:rgba(255,255,255,0.03); padding:12px; border-radius:var(--radius);">
                        <div style="font-size:0.65rem; color:var(--text-muted);">SEED VOL</div>
                        <div style="color:var(--text-primary); font-family:var(--font-mono);">$4.2B</div>
                    </div>
                </div>
            </div>
            
            <div>
                 <div class="sidebar-header"><i data-lucide="hash"></i> ACTIVE VECTORS</div>
                 <div style="display:flex; flex-direction:column; gap:8px;">
                     <span class="vector-tag">#GenerativeBiology</span>
                     <span class="vector-tag">#AgenticWorkflows</span>
                     <span class="vector-tag">#SovereignCompute</span>
                 </div>
            </div>
        </aside>

        <main class="main-feed">
            <div class="view-nav">
                <div class="nav-tabs">
                    <button class="nav-tab active" onclick="switchView('feed')">Intel Feed</button>
                    <button class="nav-tab" onclick="switchView('startups')">Seed Scout</button>
                    <button class="nav-tab" onclick="switchView('graph')">Nexus Graph</button>
                    <button class="nav-tab" onclick="switchView('heatmap')">Heat Map</button>
                </div>
            </div>

            <div class="feed-controls">
                <span class="filter-chip active" onclick="filterFeed('All', this)">All Sources</span>
                <span class="filter-chip" onclick="filterFeed('Data Center', this)">Data Center</span>
                <span class="filter-chip" onclick="filterFeed('AI', this)">AI</span>
                <span class="filter-chip" onclick="filterFeed('Policy', this)">Policy</span>
                <span class="filter-chip" onclick="filterFeed('Energy', this)">Energy</span>
                
                <div class="tldr-toggle" id="tldrToggle" onclick="toggleTLDR()">
                    <i data-lucide="zap" style="width:12px;"></i> AI SUMMARY
                </div>
            </div>

            <div id="feedView" class="view-container active">
                <div id="feedContainer"></div>
            </div>

            <div id="startupsView" class="view-container">
                <div style="margin-bottom:1.5rem;">
                    <h2 style="font-weight:600; font-size:1.2rem; margin-bottom:4px;">Deal Flow: Series Seed+</h2>
                    <p style="color:var(--text-muted); font-size:0.85rem;">High-signal opportunities sorted by Nexus Score.</p>
                </div>
                <div class="startup-grid" id="startupGrid"></div>
            </div>

            <div id="graphView" class="view-container">
                <div id="knowledgeGraph"></div>
            </div>

            <div id="heatmapView" class="view-container">
                <h2 style="font-weight:600; font-size:1.2rem; margin-bottom:1rem;">Sector Performance Heatmap</h2>
                <div id="heatMapContainer"></div>
            </div>
        </main>

        <aside class="right-sidebar">
            <div>
                <div class="sidebar-header"><i data-lucide="trending-up"></i> MARKET WATCH</div>
                <div class="market-list" id="marketWatchList">
                    </div>
            </div>

            <div>
                <div class="sidebar-header"><i data-lucide="pie-chart"></i> IMPACT DISTRIBUTION</div>
                <div id="impactChart" style="min-height: 200px;"></div>
            </div>
        </aside>

    </div>

    <div class="modal-overlay" id="settingsModal" onclick="if(event.target === this) toggleSettings()">
        <div class="settings-modal">
            <div class="modal-header">
                <h3 style="font-size:1rem; font-weight:600; display:flex; gap:10px; align-items:center;">
                    <i data-lucide="settings"></i> System Configuration
                </h3>
                <button class="action-btn" onclick="toggleSettings()"><i data-lucide="x"></i></button>
            </div>
            
            <div class="modal-body">
                <div class="settings-section">
                    <div class="settings-section-title"><i data-lucide="monitor"></i> Interface</div>
                    <div class="setting-row">
                        <span style="font-size:0.9rem;">Cyberpunk Mode</span>
                        <div class="toggle-switch active" id="cyberpunkToggle" onclick="toggleCyberpunk()"></div>
                    </div>
                    <div class="setting-row">
                        <span style="font-size:0.9rem;">Light Mode</span>
                        <div class="toggle-switch" id="lightModeToggle" onclick="toggleLightMode()"></div>
                    </div>
                    <div class="setting-row">
                        <span style="font-size:0.9rem;">Grid Layout</span>
                        <div class="toggle-switch" id="gridLayoutToggle" onclick="toggleGridLayout()"></div>
                    </div>
                    <div class="setting-row">
                        <span style="font-size:0.9rem;">Sentiment Heatmap</span>
                        <div class="toggle-switch" id="sentimentToggle" onclick="toggleSentimentOverlay()"></div>
                    </div>
                    <div class="setting-row">
                        <span style="font-size:0.9rem;">Auto-Refresh (30s)</span>
                        <div class="toggle-switch" id="autoRefreshToggle" onclick="toggleAutoRefresh()"></div>
                    </div>
                </div>

                <div class="settings-section">
                    <div class="settings-section-title"><i data-lucide="rss"></i> Data Streams & AI</div>
                    
                    <div class="api-config-container">
                        <label class="api-input-label">Select Provider to Configure</label>
                        <select id="apiProviderSelector" class="api-select" onchange="updateApiConfigUI()">
                            <option value="guardian">The Guardian (News)</option>
                            <option value="gnews">GNews (News)</option>
                            <option value="newsapi">NewsAPI (Simulation)</option>
                            <option value="finnhub">Finnhub (Stocks)</option>
                            <option value="gemini">Gemini (AI Analysis)</option>
                        </select>

                        <div id="apiConfigInputArea" class="mt-4">
                            </div>
                    </div>
                </div>

                <button class="action-btn" style="width:100%; border-color:var(--accent-green); color:var(--accent-green); font-weight:600; height:40px;" onclick="saveSettings()">Save & Close</button>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="aiAnalysisModal" onclick="if(event.target === this) closeAiModal()">
        <div class="settings-modal" style="width: 600px;">
            <div class="modal-header">
                <h3 style="font-size:1rem; font-weight:600; display:flex; gap:10px; align-items:center;">
                    <i data-lucide="brain" style="color:var(--accent-purple)"></i> Tactical Analysis
                </h3>
                <button class="action-btn" onclick="closeAiModal()"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body" id="aiModalContent">
                </div>
        </div>
    </div>

    <div class="modal-overlay" id="alertsModal" onclick="if(event.target === this) toggleAlerts()">
        <div class="settings-modal">
            <div class="modal-header">
                <h3 style="font-size:1rem; font-weight:600; display:flex; gap:10px; align-items:center;">
                    <i data-lucide="bell"></i> System Alerts
                </h3>
                <button class="action-btn" onclick="toggleAlerts()"><i data-lucide="x"></i></button>
            </div>
            <div class="modal-body">
                <div class="alert-item">
                    <i data-lucide="alert-triangle" class="alert-icon"></i>
                    <div class="alert-content">
                        <h4>Volatility Spike Detected</h4>
                        <p>Market sentiment volatility index crossed 85. High probability of rapid price action in compute futures.</p>
                        <div class="alert-time">2 mins ago</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
