<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NEXUS INTEL | AI × Data × Energy × Policy × Startups</title>
    
    <!-- Performance: Preconnect to external domains -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">
    <link rel="preconnect" href="https://unpkg.com">
    
    <!-- External Libraries -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    
    <!-- Knowledge Graph Library (Vis.js) -->
    <link href="https://unpkg.com/vis-network/styles/vis-network.min.css" rel="stylesheet" type="text/css" />
    
    <!-- Local CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- Performance: Defer non-critical scripts -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js" defer></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
    <script src="https://cdn.jsdelivr.net/npm/apexcharts" defer></script>
    <script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js" defer></script>
    
    <!-- Local JS -->
    <script src="script.js" defer></script>
</head>
<body>

    <!-- Cyberpunk Effects -->
    <div class="scanlines" style="display: none;"></div>
    <div class="crt-flicker" style="display: none;"></div>
    <div class="glow-overlay" style="display: none;"></div>

    <!-- Tooltip -->
    <div id="cyberTooltip" class="cyber-tooltip"></div>

    <!-- Notification Area -->
    <div id="notificationArea" class="notification">
        <i data-lucide="check-circle" style="color: var(--color-electric-green)"></i>
        <span id="notificationText">System Ready</span>
    </div>

    <!-- Bulk Action Bar -->
    <div id="bulkActionBar" class="bulk-action-bar">
        <div class="bulk-counter">0 SELECTED</div>
        <button class="action-btn" onclick="bulkMarkRead()" title="Mark Read"><i data-lucide="check-square"></i></button>
        <button class="action-btn" onclick="bulkBookmark()" title="Bookmark"><i data-lucide="bookmark"></i></button>
        <button class="action-btn" onclick="toggleBulkMode()" title="Exit Bulk Mode" style="border-color:#ff4757; color:#ff4757;"><i data-lucide="x"></i></button>
    </div>

    <!-- Zen Mode Overlay -->
    <div id="zenModeOverlay" class="zen-overlay">
        <div class="zen-container">
            <div class="zen-header">
                <button class="action-btn" onclick="toggleZenMode()" title="Exit Zen Mode"><i data-lucide="x"></i></button>
                <div class="zen-controls">
                    <button class="action-btn" id="zenFontDecrease" title="Decrease Font Size"><i data-lucide="minus"></i></button>
                    <button class="action-btn" id="zenFontIncrease" title="Increase Font Size"><i data-lucide="plus"></i></button>
                    <button class="action-btn" id="zenToggleDark" title="Toggle Dark/Light"><i data-lucide="moon"></i></button>
                </div>
            </div>
            <div class="zen-content" id="zenContent">
                <!-- Content populated by JS -->
            </div>
        </div>
    </div>

    <!-- Knowledge Graph Modal -->
    <div class="modal-overlay" id="knowledgeGraphModal">
        <div class="modal-content" style="max-width: 90%; height: 85vh;">
            <div class="graph-container">
                <div class="graph-header">
                    <div>
                        <h3><i data-lucide="git-branch"></i> KNOWLEDGE GRAPH</h3>
                        <p style="font-size: 0.8rem; color: var(--color-text-muted); margin-top: 5px;">Interactive network of intelligence connections</p>
                    </div>
                    <div class="graph-controls">
                        <button class="action-btn" id="graphResetView" title="Reset View"><i data-lucide="refresh-cw"></i></button>
                        <button class="action-btn" id="graphZoomIn" title="Zoom In"><i data-lide="zoom-in"></i></button>
                        <button class="action-btn" id="graphZoomOut" title="Zoom Out"><i data-lucide="zoom-out"></i></button>
                        <button class="action-btn" id="closeGraphBtn" title="Close"><i data-lucide="x"></i></button>
                    </div>
                </div>
                <div id="knowledgeGraphNetwork" style="width: 100%; height: 70vh; background: var(--color-bg-dark); border-radius: 8px;"></div>
                <div class="graph-legend">
                    <div class="legend-item"><span class="legend-color" style="background: #00ff9d;"></span> Startups</div>
                    <div class="legend-item"><span class="legend-color" style="background: #0095ff;"></span> Investors</div>
                    <div class="legend-item"><span class="legend-color" style="background: #ff9f43;"></span> Technologies</div>
                    <div class="legend-item"><span class="legend-color" style="background: #8a2be2;"></span> Markets</div>
                    <div class="legend-item"><span class="legend-color" style="background: #ff4757;"></span> High Impact</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Startup Dashboard Modal -->
    <div class="modal-overlay" id="startupDashboardModal">
        <div class="modal-content" style="max-width: 95%; height: 85vh;">
            <div class="startup-dashboard">
                <div class="dashboard-header">
                    <div>
                        <h3><i data-lucide="rocket"></i> AI STARTUP TRACKER</h3>
                        <p style="font-size: 0.8rem; color: var(--color-text-muted); margin-top: 5px;">Monitor investments, rounds, and market movements</p>
                    </div>
                    <div class="dashboard-controls">
                        <select id="startupFilter" class="sort-select" style="background: rgba(0,0,0,0.3);">
                            <option value="all">All Startups</option>
                            <option value="seed">Seed Stage</option>
                            <option value="series_a">Series A</option>
                            <option value="series_b">Series B+</option>
                            <option value="acquired">Acquired</option>
                        </select>
                        <button class="action-btn" id="closeStartupDashboardBtn" title="Close"><i data-lucide="x"></i></button>
                    </div>
                </div>
                
                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(0, 255, 157, 0.1); color: #00ff9d;">
                            <i data-lucide="trending-up"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalStartups">0</div>
                            <div class="stat-label">Tracked Startups</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(0, 149, 255, 0.1); color: #0095ff;">
                            <i data-lucide="dollar-sign"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="totalFunding">$0B</div>
                            <div class="stat-label">Total Funding</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(255, 159, 67, 0.1); color: #ff9f43;">
                            <i data-lucide="target"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="activeRounds">0</div>
                            <div class="stat-label">Active Rounds</div>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon" style="background: rgba(138, 43, 226, 0.1); color: #8a2be2;">
                            <i data-lucide="building"></i>
                        </div>
                        <div class="stat-info">
                            <div class="stat-value" id="topInvestors">0</div>
                            <div class="stat-label">Top Investors</div>
                        </div>
                    </div>
                </div>
                
                <div class="dashboard-main">
                    <div class="startup-list-container">
                        <div class="section-header">
                            <h4><i data-lucide="list"></i> STARTUP PORTFOLIO</h4>
                            <button class="action-btn" id="addStartupBtn" title="Add Startup"><i data-lucide="plus"></i></button>
                        </div>
                        <div id="startupList" class="startup-list">
                            <!-- Startups populated by JS -->
                        </div>
                    </div>
                    
                    <div class="startup-details-container">
                        <div id="startupDetails" class="startup-details">
                            <div class="empty-details">
                                <i data-lucide="rocket" size="48"></i>
                                <p>Select a startup to view details</p>
                            </div>
                        </div>
                        
                        <div class="investment-timeline">
                            <h4><i data-lucide="calendar"></i> FUNDING TIMELINE</h4>
                            <div id="fundingTimelineChart"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Startup Modal -->
    <div class="modal-overlay" id="addStartupModal">
        <div class="modal-content">
            <div class="settings-container">
                <div style="display: flex; justify-content: space-between; margin-bottom: 25px;">
                    <h2><i data-lucide="plus-circle" style="color: var(--color-electric-green); margin-right: 10px;"></i> Add New Startup</h2>
                    <button class="action-btn" onclick="document.getElementById('addStartupModal').classList.remove('active')" aria-label="Close"><i data-lucide="x"></i></button>
                </div>
                <div class="setting-group">
                    <h3><i data-lucide="info"></i> Basic Information</h3>
                    <input type="text" id="startupName" class="setting-input" placeholder="Startup Name">
                    <input type="text" id="startupFounder" class="setting-input" placeholder="Founder(s)">
                    <textarea id="startupDescription" class="setting-input" placeholder="Description (what they do)" rows="3"></textarea>
                    <input type="text" id="startupWebsite" class="setting-input" placeholder="Website URL">
                </div>
                <div class="setting-group">
                    <h3><i data-lucide="dollar-sign"></i> Funding Details</h3>
                    <select id="startupStage" class="setting-input">
                        <option value="pre_seed">Pre-Seed</option>
                        <option value="seed">Seed</option>
                        <option value="series_a">Series A</option>
                        <option value="series_b">Series B</option>
                        <option value="series_c">Series C+</option>
                        <option value="acquired">Acquired</option>
                        <option value="public">Public</option>
                    </select>
                    <input type="number" id="startupValuation" class="setting-input" placeholder="Valuation (in millions)">
                    <input type="number" id="startupRaised" class="setting-input" placeholder="Total Raised (in millions)">
                    <input type="text" id="startupInvestors" class="setting-input" placeholder="Investors (comma separated)">
                    <input type="date" id="startupLastRound" class="setting-input" placeholder="Last Round Date">
                </div>
                <div class="setting-group">
                    <h3><i data-lucide="target"></i> Technology & Market</h3>
                    <input type="text" id="startupTechnology" class="setting-input" placeholder="Core Technology">
                    <input type="text" id="startupMarket" class="setting-input" placeholder="Target Market">
                    <input type="text" id="startupCompetitors" class="setting-input" placeholder="Competitors">
                </div>
                <button id="saveStartupBtn" style="width: 100%; padding: 14px; background: var(--color-electric-green); border: none; border-radius: 8px; font-weight: 700; cursor: pointer; color: #000;">ADD STARTUP TO TRACKER</button>
            </div>
        </div>
    </div>

    <!-- Existing Modals (Search, Reader, Info, Help, Settings) remain the same -->
    <!-- Search Modal -->
    <div class="modal-overlay" id="searchModal">
        <!-- ... existing search modal code ... -->
    </div>

    <!-- Reader Modal -->
    <div class="modal-overlay" id="readerModal">
        <!-- ... existing reader modal code ... -->
    </div>

    <!-- Info/Docs Modal -->
    <div class="modal-overlay" id="infoModal">
        <!-- ... existing info modal code ... -->
    </div>

    <!-- Help Modal -->
    <div class="modal-overlay" id="helpModal">
        <!-- ... existing help modal code ... -->
    </div>

    <!-- Settings Modal -->
    <div class="modal-overlay" id="settingsModal">
        <!-- ... existing settings modal code ... -->
    </div>

    <!-- Signal Ticker -->
    <div class="signal-ticker">
        <div class="ticker-wrap">
            <div class="ticker">
                <div class="ticker-item"><i data-lucide="activity"></i> SYSTEM ONLINE</div>
                <div class="ticker-item"><i data-lucide="rocket"></i> 12 AI STARTUPS IN FUNDING ROUNDS</div>
                <div class="ticker-item"><i data-lucide="globe"></i> MONITORING GLOBAL GRIDS</div>
                <div class="ticker-item"><i data-lucide="cpu"></i> AI TRAINING RUN DETECTED</div>
                <div class="ticker-item"><i data-lucide="scale"></i> EU AI ACT COMPLIANCE CHECK</div>
                <div class="ticker-item"><i data-lucide="zap"></i> DATA CENTER LOAD: NOMINAL</div>
            </div>
        </div>
    </div>

    <!-- Main App Container -->
    <div class="app-container">
        <header class="app-header">
            <div class="logo-container">
                <div class="logo-icon"><i data-lucide="aperture" style="color: #0a0a0f;"></i></div>
                <div>
                    <h1 style="font-size: 1.2rem; font-weight: 800; letter-spacing: -0.5px;">NEXUS INTEL</h1>
                    <div style="font-size: 0.65rem; color: var(--color-text-muted); letter-spacing: 1.5px; font-weight: 600;">AI × DATA × ENERGY × POLICY × STARTUPS</div>
                </div>
            </div>
            <div class="header-actions">
                <button class="action-btn mobile-widgets-btn" id="mobileWidgetsToggle" title="Toggle Widgets"><i data-lucide="bar-chart-2"></i></button>
                <button class="action-btn" id="zenModeBtn" title="Zen Mode (Z)" aria-label="Zen Mode"><i data-lucide="moon"></i></button>
                <button class="action-btn" id="knowledgeGraphBtn" title="Knowledge Graph (G)" aria-label="Knowledge Graph"><i data-lucide="git-branch"></i></button>
                <button class="action-btn" id="startupDashboardBtn" title="Startup Tracker (T)" aria-label="Startup Tracker"><i data-lucide="rocket"></i></button>
                <button class="action-btn" id="tldrToggleBtn" title="TL;DR Mode" aria-label="TLDR Mode"><i data-lucide="list"></i></button>
                <div id="systemClock" style="font-family: 'JetBrains Mono'; font-size: 0.8rem; color: var(--color-electric-green); border: 1px solid rgba(0,255,157,0.2); padding: 8px 12px; border-radius: 8px; margin-right: 10px;">00:00:00 UTC</div>
                <button class="action-btn" id="refreshBtn" title="Refresh Feed (R)" aria-label="Refresh"><i data-lucide="refresh-cw"></i></button>
                <button class="action-btn" id="triggerSearchBtn" title="Search (Cmd+K)" aria-label="Search"><i data-lucide="search"></i></button>
                <button class="action-btn" id="triggerSettingsBtn" title="Settings (S)" aria-label="Settings"><i data-lucide="settings"></i></button>
            </div>
        </header>

        <!-- Intelligence Aggregator -->
        <div class="intelligence-aggregator">
            <div style="flex:1">
                <div style="font-size: 0.75rem; color: var(--color-text-muted); text-transform: uppercase; letter-spacing: 1px; font-weight: 700;">Global Threat Level</div>
                <div style="font-size: 1.5rem; font-weight: 700; color: #fff;">MODERATE <span style="font-size: 0.8rem; color: var(--color-electric-green); font-weight: 400;">STABLE</span></div>
            </div>
            <div style="width: 200px; display:flex; flex-direction:column; gap:5px;">
                <div style="display:flex; justify-content:space-between; font-size:0.7rem; color:var(--color-text-muted);"><span>CONFIDENCE</span><span>94%</span></div>
                <div style="height:6px; background:rgba(255,255,255,0.1); border-radius:3px;"><div style="width:94%; height:100%; background:var(--color-data-blue); border-radius:3px;"></div></div>
            </div>
        </div>

        <!-- Filter Container -->
        <div class="filter-container">
            <div class="filter-chip active" data-filter="all"><i data-lucide="layers" size="14"></i> ALL NEXUS <span class="filter-chip-count"></span><span id="badge-all" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="unread"><i data-lucide="mail" size="14"></i> UNREAD <span class="filter-chip-count"></span><span id="badge-unread" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="ai"><i data-lucide="cpu" size="14"></i> AI <span class="filter-chip-count"></span><span id="badge-ai" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="startup"><i data-lucide="rocket" size="14"></i> STARTUPS <span class="filter-chip-count"></span><span id="badge-startup" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="energy"><i data-lucide="zap" size="14"></i> ENERGY <span class="filter-chip-count"></span><span id="badge-energy" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="realestate"><i data-lucide="building" size="14"></i> REAL ESTATE <span class="filter-chip-count"></span><span id="badge-realestate" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="policy"><i data-lucide="scale" size="14"></i> POLICY <span class="filter-chip-count"></span><span id="badge-policy" class="chip-badge"></span></div>
            <div class="filter-chip" data-filter="breaking"><i data-lucide="alert-circle" size="14"></i> BREAKING <span class="filter-chip-count"></span></div>
            <div class="filter-chip" data-filter="saved"><i data-lucide="bookmark" size="14"></i> SAVED <span class="filter-chip-count"></span></div>
        </div>

        <!-- Left Sidebar -->
        <aside class="left-sidebar">
            <div class="sidebar-section">
                <h3><i data-lucide="map"></i> GEOSPATIAL INTEL</h3>
                <div id="miniMap">
                    <div class="map-scan-overlay"></div>
                </div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="pie-chart"></i> IMPACT DISTRIBUTION</h3>
                <div id="impactChart"></div>
            </div>
            <div class="sidebar-section">
                <h3><i data-lucide="hash"></i> TRENDING SIGNALS</h3>
                <div id="trendingContainer">
                    <!-- Data populated by JS -->
                </div>
            </div>
        </aside>

        <!-- Main Feed -->
        <main class="main-feed" id="mainFeed">
            <div id="breakingBanner" class="breaking-banner">
                <div style="display:flex; align-items:center; gap:12px;">
                    <i data-lucide="alert-triangle"></i>
                    <span id="breakingText">BREAKING: MAJOR REGULATORY SHIFT DETECTED</span>
                </div>
                <i data-lucide="arrow-right" size="16"></i>
            </div>

            <div class="feed-header">
                <div style="display:flex; align-items:center; gap: 15px;">
                    <h2 id="feedTitle" style="font-size:1.1rem; font-weight:700;">LIVE INTELLIGENCE</h2>
                    <span style="font-size:0.75rem; background:rgba(255,255,255,0.1); padding:4px 8px; border-radius:4px;"><span id="articleCount">0</span> NODES</span>
                </div>
                <div class="feed-controls">
                     <div class="view-toggle">
                        <button class="view-btn active" data-view="row" title="Row View"><i data-lucide="rows" size="16"></i></button>
                        <button class="view-btn" data-view="grid" title="Grid View"><i data-lucide="layout-grid" size="16"></i></button>
                    </div>
                    <div style="width: 1px; height: 24px; background: rgba(255,255,255,0.1); margin: 0 10px;"></div>
                    <select id="sortSelect" class="sort-select" aria-label="Sort Articles">
                        <option value="latest">Latest</option>
                        <option value="unread_first">Unread First</option>
                        <option value="read_first">Read First</option>
                        <option value="impact">Highest Impact</option>
                        <option value="startup_stage">Startup Stage</option>
                    </select>
                </div>
            </div>

            <div id="articlesContainer"></div>
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar" id="rightSidebar">
            <div class="sidebar-section">
                <div class="brief-header" onclick="toggleBrief()">
                    <h3><i data-lucide="list"></i> TOP INTELLIGENCE BRIEF</h3>
                    <i data-lucide="chevron-up" id="briefChevron" style="width:16px; transition: transform 0.3s;"></i>
                </div>
                <div id="topBriefWidget" class="brief-content-wrapper">
                    <!-- Filled by JS -->
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="gauge"></i> MARKET SENTIMENT</h3>
                <div class="sentiment-gauge-wrapper">
                    <div id="sentimentRadialChart"></div>
                    <div class="sentiment-value-overlay">
                        <div id="sentimentValue" class="sentiment-score">--</div>
                        <div id="sentimentText" class="sentiment-text">ANALYZING</div>
                    </div>
                </div>
            </div>

            <div class="sidebar-section">
                <h3><i data-lucide="activity"></i> STARTUP ACTIVITY</h3>
                <div class="stat-grid">
                    <div class="health-bar-container">
                        <div class="health-label"><span>SEED STAGE</span><span style="color:#00ff9d" id="seedCount">0</span></div>
                        <div class="health-progress-bg"><div class="health-progress-fill" style="width:0%; background:#00ff9d" id="seedBar"></div></div>
                    </div>
                    <div class="health-bar-container">
                        <div class="health-label"><span>SERIES A</span><span style="color:#0095ff" id="seriesACount">0</span></div>
                        <div class="health-progress-bg"><div class="health-progress-fill" style="width:0%; background:#0095ff" id="seriesABar"></div></div>
                    </div>
                    <div class="health-bar-container">
                        <div class="health-label"><span>SERIES B+</span><span style="color:#ff9f43" id="seriesBCount">0</span></div>
                        <div class="health-progress-bg"><div class="health-progress-fill" style="width:0%; background:#ff9f43" id="seriesBBar"></div></div>
                    </div>
                </div>
                <div style="margin-top: 15px;">
                    <button class="ai-analysis-btn" onclick="openStartupDashboard()" style="font-size: 0.7rem; padding: 8px;">
                        <i data-lucide="rocket"></i> OPEN STARTUP TRACKER
                    </button>
                </div>
            </div>

            <div class="sidebar-section">
                <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.2rem;">
                    <h3 style="margin-bottom:0"><i data-lucide="bookmark"></i> QUICK SAVED</h3>
                    <button id="downloadBriefBtn" style="background:none; border:none; color:var(--color-electric-green); cursor:pointer; font-size:0.7rem; font-weight:700; display:none; letter-spacing:0.5px;">
                        <i data-lucide="download" size="12" style="margin-right:4px;"></i> EXPORT
                    </button>
                </div>
                <div id="quickSavedList" style="font-size: 0.85rem; display: flex; flex-direction: column; gap: 12px;">
                    <span style="color: var(--color-text-muted); font-style: italic; font-size: 0.8rem;">No bookmarks yet.</span>
                </div>
            </div>
        </aside>

        <!-- Footer -->
        <footer class="app-footer">
            <div class="footer-status">
                <div class="footer-status-item"><div class="status-dot"></div><span>SECURE TLS v1.3</span></div>
                <div class="footer-status-item"><span>LATENCY: <span id="footerLatency">12ms</span></span></div>
                <div class="footer-status-item" id="sessionStatus" style="color:var(--color-electric-green); opacity:0; transition:opacity 0.5s;"><span>SESSION SAVED</span></div>
                <div class="footer-status-item" id="zenStatus" style="color:var(--color-data-blue); display:none;"><i data-lucide="moon" size="12"></i> ZEN MODE: READY</div>
            </div>
            <div class="footer-center">NEXUS INTEL v4.1.0 (BETA) | © 2026</div>
            <div class="footer-links">
                <span class="footer-link" onclick="openInfoModal('api')">API DOCS</span>
                <span class="footer-link" onclick="openKnowledgeGraph()">KNOWLEDGE GRAPH</span>
                <span class="footer-link" onclick="openStartupDashboard()">STARTUP TRACKER</span>
                <span class="footer-link" onclick="openInfoModal('privacy')">PRIVACY</span>
            </div>
        </footer>
    </div>

</body>
</html>
